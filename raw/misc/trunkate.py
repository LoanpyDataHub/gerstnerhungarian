"""will remove rows that can't be linked to concepticon"""

from pathlib import Path
import re

import pandas as pd
from pysem.glosses import to_concepticon

in_path = Path.cwd().parent / "Gerstner-2016-3532.tsv"
out_path = Path.cwd().parent / "Gerstner_trunk.tsv"

def gg(d):
    """dict vals to tuples (ID, Gloss) or ("", "")"""
    return {k: (d[k][0][0], d[k][0][1]) if d[k] else ("", "") for k in d}
    
def main():
    """"
    read Gerstner-2016-10085.tsv,
    link data to concepticon,
    write concepts.tsv
    """
    # read file and clean column "sense"
    dfuesz = pd.read_csv(in_path, sep="\t", usecols=["form", "sense", "year", "origin", "Loan"]).dropna(subset=["sense"])
    for i in master.split("\n"):
    	if i not in dfuesz.form: print(i)
    dfuesz = dfuesz[dfuesz['form'].isin(master.split("\n"))]


    # define list of dictionaries and plug into to_concepticon()
    glo = [{"gloss": g, "year": y, "origin": o} for g,y,o in zip(dfuesz.sense, dfuesz.year, dfuesz.origin)]
    G = gg(to_concepticon(glo, language="de", max_matches=1))

    # map dictionary to new columns
    newcols = ["Concepticon_ID", "Concepticon_Gloss"]
    dfuesz[newcols] = dfuesz['sense'].map(G).tolist()
    
    dfuesz.to_csv(out_path, index=False, encoding="utf-8", sep="\t")
    pd.read_csv(out_path, sep="\t").dropna(subset=["Concepticon_ID"]).to_csv(out_path, index=False, encoding="utf-8", sep="\t")
    
master = """szem
fül
orr
száj
fog
nyelv
ajak
orca
arc
homlok
haj
bajusz
szakáll
áll
állkapocs
gége
torok
nyak
tarkó
fő
fej
hát
has
köldök
mell
kebel
mell
váll
kar
könyök
kéz
tenyér
ujj
köröm
köröm
lábujj
láb
sarok
térd
comb
láb
lábszár
test
bőr
vér
ér
ín
csont
agy
agyvelő
szív
gyomor
máj
lehelet
lélegzet
éhség
könny
íz
szag
álom
alvás
álom
ég
menny
nap
hold
csillag
levegő
szél
hullám
víz
kő
föld
talaj
föld
por
füst
szikra
tűz
fény
árnyék
idő
időjárás
köd
felhő
eső
hó
jég
fagy
hideg
hő
hőség
zúzmara
szivárvány
dörgés
mennydörgés
áramlat
csepp
hab
tajték
piszok
tó
mocsár
láp
rét
mező
erdő
domb
magaslat
hegy
csúcs
barlang
lejtő
forrás
patak
folyó
part
tengerpart
szárazföld
tenger
öböl
sziget
virág
fű
gyökér
fa
tő
törzs
kéreg
ág
gally
levél
nyír
fenyő
fűz
fenyő
szarv
toll
szőr
bunda
szárny
köröm
karom
farok
tojás
fészek
odú
állat
nyáj
csorda
tehén
bika
ló
juh
birka
sertés
eb
kutya
macska
medve
mókus
jávorszarvas
róka
nyúl
egér
farkas
madár
raj
tyúk
kakas
lúd
liba
sas
kacsa
bagoly
daru
varjú
kakukk
hattyú
hal
sügér
csuka
kígyó
kukac
pók
hangya
tetű
szúnyog
légy
lepke
pillangó
bogyó
alma
gomba
hagyma
vetőmag
mag
szem
széna
héj
verem
csapda
tőr
nyom
hamu
sár
piszok
vas
arany
ezüst
szén
üveg
agyag
vályog
homok
ember
úr
férfi
nő
asszony
gyerek
gyermek
fiú
lány
család
nagyapa
nagyanya
szülők
apa
atya
anya
fiú
lány
fivér
testvér
nővér
lánytestvér
nagybácsi
nagynéni
férj
feleség
öröm
nevetés
hahotázás
boldogság
bánat
óhaj
kedv
elme
szellem
gondolat
emlékezet
ész
értelem
értelem
ok
alap
igaz
igazság
beszélgetés
mese
elbeszélés
hír
híradás
újság
név
rejtvény
beszéd
szónoklat
nyelv
hang
szó
jel
kiáltás
zaj
hang
hang
dal
ének
csend
nyugalom
emberek
nép
dolog
vendég
ajándék
játék
társaság
segítség
barát
társ
ügy
szám
faj
fajta
darab
rész
fél
kör
kereszt
vonal
vonás
köz
távolság
táj
vidék
hely
hely
fél
oldal
közép
tárgy
dolog
szél
perem
szegély
él
sarok
szöglet
csúcs
vég
lyuk
szög
minta
nagyság
hossz
hosszúság
magasság
súly
sokaság
mennyiség
halom
sor
csónak
evező
szánkó
sí
tábortűz
teher
járás
lépés
észak
dél
nyugat
kelet
fa
deszka
lap
lemez
támasz
támaszték
rúd
pózna
pálca
bot
cső
ház
otthon
kályha
padló
asztal
szék
bölcső
ágy
polc
állvány
láda
ablak
ajtó
kapu
kerítés
tető
létra
seprű
ásó
lapát
villa
kanál
kés
szeg
háló
kampó
nyél
fogantyú
zár
kép
alak
bábu
zacskó
köteg
táska
vödör
fedő
fedél
edény
zsák
csésze
fazék
üst
bogrács
evés
étkezés
ennivaló
étel
hús
gabona
pép
kása
kenyér
szelet
háj
zsír
vaj
olaj
só
leves
méz
tej
tea
bőr
gyapjú
szövet
tű
fonál
gomb
csomó
szín
festék
ruha
ruházat
ing
gallér
ujj
gatya
nadrág
öv
sapka
cipő
csizma
gyűrű
szalag
fésű
tükör
szíj
zsinór
póráz
takaró
párna
kendő
törülköző
erő
erő
erősség
egészség
kór
betegség
fájdalom
seb
láz
orvosság
gyógyszer
híd
kút
legelő
ösvény
út
út
falu
város
levél
könyv
betű
újság
hírlap
élet
halál
sír
templom
bűn
vétek
isten
munkás
főnök
mester
orvos
tanár
tanító
pénz
üzlet
bolt
ár
áru
haszon
gazdagság
világ
ország
állam
király
hatalom
határ
háború
ellenség
erőszak
harc
íj
nyíl
puska
fegyver
hiba
hazugság
kár
csapás
balszerencse
bűn
kor
vég
befejezés
idő
nap
reggel
dél
este
éj
éjszaka
hét
hó
hónap
év
tavasz
nyár
ősz
tél
január
február
március
április
május
június
július
augusztus
szeptember
október
november
december
hétfő
kedd
szerda
csütörtök
péntek
szombat
vasárnap
nagy
pici
kicsi
hosszú
rövid
széles
keskeny
sűrű
vastag
vékony
vékony
szilárd
sík
lapos
sima
kemény
puha
kerek
hegyes
éles
tompa
életlen
nehéz
súlyos
szép
forró
meleg
hideg
hűs
hűvös
üde
friss
nedves
vizes
száraz
telt
üres
nyílt
nyitott
zárt
csukott
tiszta
piszkos
szennyes
nyers
érett
finom
édes
keserű
savanyú
világos
sötét
fekete
fehér
vörös
sárga
kék
zöld
ősz
szürke
tarka
színes
olcsó
drága
értékes
vak
süket
erős
erős
gyenge
erőtlen
hájas
karcsú
csinos
rossz
gonosz
buta
ostoba
lusta
szorgalmas
fukar
fösvény
okos
eszes
ügyes
drága
kedves
víg
vidám
enyhe
éhes
beteg
csupasz
meztelen
bús
szomorú
élő
jó
rossz
helyes
rossz
igaz
ó
régi
új
volt
egykori
öreg
fiatal
szegény
gazdag
ismert
ismeretes
híres
idegen
különböző
közeli
távoli
bal
jobb
más
másik
első
második
harmadik
utolsó
egyedül
egyszerre
együtt
összesen
sokáig
hosszan
hirtelen
egyszerre
rögtön
tüstént
későn
most
ma
holnap
majd
nemsokára
akkor
tegnap
hajdan
akkor
akkoriban
azután
előbb
először
egyszer
néha
olykor
sokszor
mindig
sohasem
itt
erre
innen
ott
oda
egyenesen
előre
hátrafelé
hátra
vissza
alul
le
lefelé
fenn
felül
fel
felfelé
mindenütt
nem
egy kicsit
alig
nagyon
úgy
még
csak
csupán
már
ismét
megint
hiába
előtt
mögött
alatt
át
keresztül
mellett
között
miatt
végett
ez
az
minden
én
te
ő
mi
ti
ők
mi
ki
hol
hova
hogy
hogyan
miért
hány
mennyi
egy
kettő
három
négy
öt
hat
hét
nyolc
kilenc
tíz
tizenegy
tizenkettő
húsz
harminc
negyven
ötven
hatvan
hetven
nyolcvan
kilencven
száz
ezer
és
meg
vagy
áll
ül
fekszik
függ
lesz
történik
kezdődik
végződik
befejeződik
változik
kel
lemegy
süt
dörög
fúj
áramlik
folyik
forog
inog
ingadozik
leng
esik
ég
füstöl
esik
megfagy
olvad
olvad
elolvad
szárad
forr
rothad
elrothad
megrothad
szakad
süllyed
elsüllyed
múlik
elmúlik
feltűnik
megjelenik
letűnik
süllyed
apad
csökken
növekszik
gyarapszik
emelkedik
nő
terem
növekszik
ragyog
fénylik
csillog
tündöklik
lármázik
cseng
csenget
csörömpöl
zúg
morajlik
zúg
hangzik
ugat
bőg
üvölt
fúj
fütyül
kiált
kiabál
nyög
remeg
reszket
él
születik
lélegzik
iszik
eszik
nyel
elfárad
kifárad
elalszik
alszik
felébred
felkel
pihen
megbetegedik
belebetegszik
betegeskedik
fáj
köhög
meggyógyul
hal
elpusztul
mozog
mozdul
feláll
felemelkedik
ül
leül
bukik
elesik
jár
lép
sétál
siet
siet
robog
fut
szalad
ugrik
kúszik
hintázik
kúszik
úszik
merül
evez
jár
megy
utazik
száll
megy
elmegy
indul
megáll
bemegy
belép
jön
érkezik
megérkezik
visszajön
marad
megmarad
vár
várakozik
vár
megvár
kutat
talál
megpróbál
megkísérel
előkészít
szeret
szeret
nevet
mozdít
sír
szid
szitkozódik
mérgelődik
bosszankodik
fél
retteg
fél
menekül
elmenekül
néz
megnéz
néz
ránéz
megnéz
hall
hallgat
meghallgat
kóstol
megkóstol
szagol
érez
tűnik
látszik
mutatkozik
hall
fázik
csinál
cselekszik
tud
akar
kezd
befejez
megszűnik
sikerül
kerül
jut
nyit
kinyit
csuk
becsuk
állít
helyez
ültet
helyez
tesz
fektet
érint
beköt
összeköt
betakar
beborít
felakaszt
gyújt
meggyújt
felemel
hátrahagy
veszít
elveszít
elejt
tesz
csinál
gyárt
előállít
épít
javít
kijavít
megjavít
megjavít
változtat
megváltoztat
ás
meghajt
hajlít
forgat
fordít
megfordít
megfordít
megforgat
emel
felemel
megfog
tart
nyom
megnyom
tol
vakar
nyal
harap
letép
levág
köt
kötöz
dug
tör
eltör
kopogtat
vág
levág
tapaszt
dörzsöl
súrol
simít
fen
csiszol
köszörül
vág
szel
metsz
ráz
ráz
megráz
lóbál
lobogtat
önt
tölt
megtölt
becsavar
hord
vonszol
húz
megőriz
dob
hajít
fog
megragad
eldug
elrejt
oszt
megoszt
küld
hoz
visz
hozzáad
kap
megkap
kap
megkap
vesz
választ
kiválaszt
megtart
akadályoz
gátol
elront
rongál
eltör
széttör
kettétör
eltép
széttép
elpusztít
éget
eléget
ad
nyújt
ajándékoz
ígér
kíván
dicsér
csókol
ringat
betakar
kelt
ébreszt
mutat
visz
vezet
tanít
tanít
felnevel
vezet
vezérel
hajt
-tat
-at
meghív
egyesít
látogat
talál
gyülekezik
összegyűlik
játszik
énekel
táncol
elválik
elhagy
ment
őriz
óv
véd
véd
verekszik
lő
győz
bosszant
üt
ver
rúg
döf
szúr
lök
lop
zavar
zaklat
rejt
elrejt
megtéveszt
csal
öl
lakik
dolgozik
szed
gyűjt
szed
vadászik
halászik
fog
őriz
legeltet
hajt
köt
etet
fej
vág
öntöz
érik
elkészít
főz
süt
süt
megkever
köt
varr
fest
tisztít
mos
letöröl
mosogat
söpör
söpör
fürdik
mosdik
mosakszik
levesz
felölt
felvesz
öltözik
felöltözik
fésül
díszít
mond
beszél
beszél
beszélget
kérdez
kér
mesél
elbeszél
közöl
hív
nevez
hív
dicsekszik
fordít
gondol
hisz
észrevesz
ráismer
felismer
felfog
ért
megért
tanul
megtanul
tud
emlékszik
felejt
elfelejt
mér
megmér
számol
megszámol
számít
olvas
fest
rajzol
ír
birtokol
vesz
megvesz
elad
fizet
kifizet
fizet
megfizet
ural
elbír
elvisel"""

if __name__ == "__main__":
    main()
